<div [class]="containerClasses()">
  <!-- Content Area -->
  <div #contentArea>
    <!-- Always render markdown (progressively during streaming) -->
    <div [class]="contentClasses()">
      <span [innerHTML]="renderedHtml()"></span>
      @if (isStreaming() && showCursor()) {
        <span [class]="cursorClasses()">â–Š</span>
      }
    </div>
  </div>

  <!-- Action Bar -->
  @if (showActions()) {
    <div [class]="actionsClasses()">
      <!-- Copy Button -->
      <button
        type="button"
        [class]="actionButtonClasses()"
        (click)="handleCopy()"
        [attr.aria-label]="justCopied() ? 'Copied!' : 'Copy response'"
      >
        @if (justCopied()) {
          <ng-icon name="lucideCheck" class="text-base text-emerald-500" />
        } @else {
          <ng-icon name="lucideCopy" class="text-base" />
        }
      </button>

      <!-- Regenerate Button -->
      <button
        type="button"
        [class]="actionButtonClasses()"
        (click)="handleRegenerate()"
        aria-label="Regenerate response"
      >
        <ng-icon name="lucideRefreshCw" class="text-base" />
      </button>

      <!-- Spacer -->
      <div class="flex-1"></div>

      <!-- Thumbs Up Button -->
      <button
        type="button"
        [class]="actionButtonClasses()"
        (click)="handleThumbsUp()"
        [attr.aria-label]="
          thumbsUpSelected() ? 'Remove positive feedback' : 'Good response'
        "
        [attr.aria-pressed]="thumbsUpSelected()"
      >
        <ng-icon
          name="lucideThumbsUp"
          class="text-base"
          [class.text-emerald-500]="thumbsUpSelected()"
        />
      </button>

      <!-- Thumbs Down Button -->
      <button
        type="button"
        [class]="actionButtonClasses()"
        (click)="handleThumbsDown()"
        [attr.aria-label]="
          thumbsDownSelected() ? 'Remove negative feedback' : 'Bad response'
        "
        [attr.aria-pressed]="thumbsDownSelected()"
      >
        <ng-icon
          name="lucideThumbsDown"
          class="text-base"
          [class.text-red-500]="thumbsDownSelected()"
        />
      </button>
    </div>
  }
</div>
