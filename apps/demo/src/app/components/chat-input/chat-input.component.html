<div [class]="containerClasses()">
  <div [class]="cardClasses()">
    <!-- Top: Context Button -->
    <div class="px-4 pt-4">
      <button
        type="button"
        hlmBtn
        variant="outline"
        size="sm"
        class="h-8 rounded-full px-3 text-xs font-normal"
        aria-label="Add context"
      >
        <span class="mr-1 text-sm">&#64;</span>
        Add context
      </button>
    </div>

    <!-- Middle: Textarea -->
    <div class="px-4 py-3">
      <textarea
        #textareaRef
        [class]="textareaClasses()"
        [placeholder]="placeholder()"
        [disabled]="disabled()"
        [value]="inputValue()"
        (input)="handleInput($event)"
        (keydown)="handleKeydown($event)"
        rows="1"
        aria-label="Message input"
        aria-describedby="keyboard-hint"
      ></textarea>
      <span id="keyboard-hint" class="sr-only">
        Press Enter to send, Shift+Enter for new line, Escape to clear
      </span>
    </div>

    <!-- Bottom: Toolbar -->
    <div [class]="toolbarClasses()">
      <!-- Left side: Action buttons -->
      <div class="flex items-center gap-1">
        <!-- Attachment -->
        <button
          type="button"
          hlmBtn
          variant="ghost"
          size="icon"
          class="h-8 w-8 text-[var(--foreground-muted)] hover:text-[var(--foreground)]"
          aria-label="Attach file"
        >
          <svg
            class="h-5 w-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"
            />
          </svg>
        </button>

        <!-- Research -->
        <button
          type="button"
          hlmBtn
          variant="ghost"
          size="sm"
          class="h-8 gap-1.5 px-2 text-[var(--foreground-muted)] hover:text-[var(--foreground)]"
          aria-label="Research"
        >
          <svg
            class="h-4 w-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
            />
          </svg>
          <span class="text-xs font-medium">Research</span>
        </button>

        <!-- All sources -->
        <button
          type="button"
          hlmBtn
          variant="ghost"
          size="sm"
          class="h-8 gap-1.5 px-2 text-[var(--foreground-muted)] hover:text-[var(--foreground)]"
          aria-label="Select sources"
        >
          <svg
            class="h-4 w-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"
            />
          </svg>
          <span class="text-xs font-medium">All sources</span>
          <svg
            class="h-3 w-3"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            />
          </svg>
        </button>

        <!-- Model name -->
        <span class="ml-1 text-xs font-medium text-[var(--foreground-muted)]">
          Angular AI
        </span>
      </div>

      <!-- Right side: Mic + Send -->
      <div class="flex items-center gap-2">
        <!-- Mic button -->
        <button
          type="button"
          hlmBtn
          variant="ghost"
          size="icon"
          class="h-8 w-8 text-[var(--foreground-muted)] hover:text-[var(--foreground)]"
          aria-label="Voice input"
        >
          <svg
            class="h-5 w-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"
            />
          </svg>
        </button>

        <!-- Send button -->
        <button
          type="button"
          hlmBtn
          [variant]="canSend() ? 'default' : 'secondary'"
          size="icon"
          [class]="sendButtonClasses()"
          [disabled]="!canSend()"
          [attr.aria-disabled]="!canSend()"
          (click)="handleSend()"
          aria-label="Send message"
        >
          <svg
            class="h-5 w-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 10l7-7m0 0l7 7m-7-7v18"
            />
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>
