/* Angular AI Kit Demo - Design System
 * Architecture: Tailwind CSS v4 + Minimal CSS Variables for Spartan UI
 * Color Scale: Zinc (Tailwind built-in)
 */

@layer theme, base, components, utilities;
@import 'tailwindcss/theme.css' layer(theme);
@import 'tailwindcss/preflight.css' layer(base);
@import 'tailwindcss/utilities.css';
@import '@spartan-ng/brain/hlm-tailwind-preset.css';

/* Custom theme extensions (variables not in Spartan preset) */
@theme inline {
  /* Code blocks */
  --color-code: var(--code);
  --color-code-foreground: var(--code-foreground);
  --color-doc-code: var(--doc-code);
  --color-doc-code-foreground: var(--doc-code-foreground);

  /* Extended tokens */
  --color-border-hover: var(--border-hover);
  --color-foreground-muted: var(--foreground-muted);

  /* Message bubble role colors */
  --color-message-user-bg: var(--message-user-bg);
  --color-message-assistant-bg: var(--message-assistant-bg);
  --color-message-system-bg: var(--message-system-bg);
  --color-avatar-user: var(--avatar-user);
  --color-avatar-assistant: var(--avatar-assistant);
  --color-avatar-system: var(--avatar-system);
}

/* Typography plugin for prose styling */
@plugin '@tailwindcss/typography';

@source '../../packages';

/* ============================================
   Semantic Design Tokens
   Using Tailwind theme() for all color values
   ============================================ */

@layer base {
  /* Light Theme (Default) */
  :root {
    /* Core Colors */
    --background: theme('colors.white');
    --foreground: theme('colors.zinc.950');

    /* Card */
    --card: theme('colors.zinc.50');
    --card-foreground: theme('colors.zinc.950');

    /* Popover */
    --popover: theme('colors.white');
    --popover-foreground: theme('colors.zinc.950');

    /* Muted */
    --muted: theme('colors.zinc.100');
    --muted-foreground: theme('colors.zinc.500');

    /* Accent */
    --accent: theme('colors.zinc.100');
    --accent-foreground: theme('colors.zinc.900');

    /* Border & Input */
    --border: theme('colors.zinc.200');
    --border-hover: theme('colors.zinc.300');
    --input: theme('colors.zinc.50');

    /* Inline/Markdown code blocks (subtle) */
    --code: theme('colors.zinc.100');
    --code-foreground: theme('colors.zinc.900');

    /* Doc code blocks (prominent/terminal-like) */
    --doc-code: theme('colors.zinc.100');
    --doc-code-foreground: theme('colors.zinc.900');

    /* Message bubble role colors */
    --message-user-bg: theme('colors.zinc.100');
    --message-assistant-bg: theme('colors.white');
    --message-system-bg: theme('colors.zinc.50');
    --avatar-user: theme('colors.zinc.700');
    --avatar-assistant: theme('colors.zinc.800');
    --avatar-system: theme('colors.zinc.400');

    /* Foreground variants */
    --foreground-muted: theme('colors.zinc.500');

    /* Ring */
    --ring: theme('colors.zinc.400');

    /* Primary */
    --primary: theme('colors.zinc.900');
    --primary-foreground: theme('colors.zinc.50');

    /* Secondary */
    --secondary: theme('colors.zinc.100');
    --secondary-foreground: theme('colors.zinc.900');

    /* Destructive */
    --destructive: theme('colors.red.500');
    --destructive-foreground: theme('colors.zinc.50');

    /* Border Radius */
    --radius: 0.5rem;
  }

  /* Dark Theme */
  .dark {
    /* Core Colors */
    --background: theme('colors.zinc.950');
    --foreground: theme('colors.zinc.50');

    /* Card */
    --card: theme('colors.zinc.900');
    --card-foreground: theme('colors.zinc.50');

    /* Popover */
    --popover: theme('colors.zinc.900');
    --popover-foreground: theme('colors.zinc.50');

    /* Muted */
    --muted: theme('colors.zinc.900');
    --muted-foreground: theme('colors.zinc.400');

    /* Accent */
    --accent: theme('colors.zinc.800');
    --accent-foreground: theme('colors.zinc.50');

    /* Border & Input */
    --border: theme('colors.zinc.800');
    --border-hover: theme('colors.zinc.600');
    --input: theme('colors.zinc.900');

    /* Inline/Markdown code blocks (subtle) */
    --code: theme('colors.zinc.950');
    --code-foreground: theme('colors.zinc.100');

    /* Doc code blocks (prominent/terminal-like) */
    --doc-code: theme('colors.zinc.900');
    --doc-code-foreground: theme('colors.zinc.100');

    /* Message bubble role colors */
    --message-user-bg: theme('colors.zinc.800');
    --message-assistant-bg: theme('colors.zinc.900');
    --message-system-bg: theme('colors.zinc.800/50');
    --avatar-user: theme('colors.zinc.600');
    --avatar-assistant: theme('colors.zinc.700');
    --avatar-system: theme('colors.zinc.500');

    /* Foreground variants */
    --foreground-muted: theme('colors.zinc.500');

    /* Ring */
    --ring: theme('colors.zinc.500');

    /* Primary */
    --primary: theme('colors.zinc.50');
    --primary-foreground: theme('colors.zinc.900');

    /* Secondary */
    --secondary: theme('colors.zinc.800');
    --secondary-foreground: theme('colors.zinc.50');
  }

  /* Base HTML Styles */
  html {
    scroll-behavior: smooth;
  }

  body {
    font-family: theme('fontFamily.sans');
    background-color: var(--background);
    color: var(--foreground);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Selection */
  ::selection {
    background-color: var(--primary);
    color: var(--primary-foreground);
  }

  /* Focus Ring */
  :focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
  }

  /* Scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 9999px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--muted-foreground);
  }

  /* Firefox scrollbar */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }
}

/* ============================================
   Component Styles
   ============================================ */

@layer components {
  /* CDK Dialog Overlay */
  .cdk-overlay-dark-backdrop {
    background-color: rgb(0 0 0 / 0.5);
    backdrop-filter: blur(4px);
    animation: overlay-fade-in 150ms ease-out;
  }

  /* Command Dialog Panel */
  .command-dialog-panel {
    background-color: var(--background);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: theme('boxShadow.lg');
    overflow: hidden;
    outline: none;
    animation: dialog-slide-in 150ms ease-out;
  }

  /* CDK Overlay Centering */
  .cdk-global-overlay-wrapper {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding-top: 15vh;
  }

  /* Dialog Animations */
  @keyframes overlay-fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes dialog-slide-in {
    from {
      opacity: 0;
      transform: scale(0.95) translateY(-10px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  /* Sidebar Host */
  .app-sidebar-host {
    overflow-x: hidden !important;
  }

  /* ============================================
     Highlight.js Code Syntax Theme (Light - GitHub Light)
     ============================================ */
  .hljs {
    color: #24292f;
    background: transparent;
  }

  .hljs-doctag,
  .hljs-keyword,
  .hljs-meta .hljs-keyword,
  .hljs-template-tag,
  .hljs-template-variable,
  .hljs-type,
  .hljs-variable.language_ {
    color: #cf222e;
  }

  .hljs-title,
  .hljs-title.class_,
  .hljs-title.class_.inherited__,
  .hljs-title.function_ {
    color: #8250df;
  }

  .hljs-attr,
  .hljs-attribute,
  .hljs-literal,
  .hljs-meta,
  .hljs-number,
  .hljs-operator,
  .hljs-variable,
  .hljs-selector-attr,
  .hljs-selector-class,
  .hljs-selector-id {
    color: #0550ae;
  }

  .hljs-regexp,
  .hljs-string,
  .hljs-meta .hljs-string {
    color: #0a3069;
  }

  .hljs-built_in,
  .hljs-symbol {
    color: #953800;
  }

  .hljs-comment,
  .hljs-code,
  .hljs-formula {
    color: #6e7781;
  }

  .hljs-name,
  .hljs-quote,
  .hljs-selector-tag,
  .hljs-selector-pseudo {
    color: #116329;
  }

  .hljs-subst {
    color: #24292f;
  }

  .hljs-section {
    color: #0550ae;
    font-weight: bold;
  }

  .hljs-bullet {
    color: #953800;
  }

  .hljs-emphasis {
    color: #24292f;
    font-style: italic;
  }

  .hljs-strong {
    color: #24292f;
    font-weight: bold;
  }

  .hljs-addition {
    color: #116329;
    background-color: #dafbe1;
  }

  .hljs-deletion {
    color: #cf222e;
    background-color: #ffebe9;
  }

  /* Dark theme syntax highlighting */
  .dark .hljs {
    color: #c9d1d9;
  }

  .dark .hljs-doctag,
  .dark .hljs-keyword,
  .dark .hljs-meta .hljs-keyword,
  .dark .hljs-template-tag,
  .dark .hljs-template-variable,
  .dark .hljs-type,
  .dark .hljs-variable.language_ {
    color: #ff7b72;
  }

  .dark .hljs-title,
  .dark .hljs-title.class_,
  .dark .hljs-title.class_.inherited__,
  .dark .hljs-title.function_ {
    color: #d2a8ff;
  }

  .dark .hljs-attr,
  .dark .hljs-attribute,
  .dark .hljs-literal,
  .dark .hljs-meta,
  .dark .hljs-number,
  .dark .hljs-operator,
  .dark .hljs-variable,
  .dark .hljs-selector-attr,
  .dark .hljs-selector-class,
  .dark .hljs-selector-id {
    color: #79c0ff;
  }

  .dark .hljs-regexp,
  .dark .hljs-string,
  .dark .hljs-meta .hljs-string {
    color: #a5d6ff;
  }

  .dark .hljs-built_in,
  .dark .hljs-symbol {
    color: #ffa657;
  }

  .dark .hljs-comment,
  .dark .hljs-code,
  .dark .hljs-formula {
    color: #8b949e;
  }

  .dark .hljs-name,
  .dark .hljs-quote,
  .dark .hljs-selector-tag,
  .dark .hljs-selector-pseudo {
    color: #7ee787;
  }

  .dark .hljs-subst {
    color: #c9d1d9;
  }

  .dark .hljs-section {
    color: #1f6feb;
    font-weight: bold;
  }

  .dark .hljs-bullet {
    color: #f2cc60;
  }

  .dark .hljs-emphasis {
    color: #c9d1d9;
    font-style: italic;
  }

  .dark .hljs-strong {
    color: #c9d1d9;
    font-weight: bold;
  }

  .dark .hljs-addition {
    color: #aff5b4;
    background-color: #033a16;
  }

  .dark .hljs-deletion {
    color: #ffdcd7;
    background-color: #67060c;
  }

  /* ============================================
     Professional Code Block Styling (ChatGPT/Claude-like)
     ============================================ */

  /* Code block wrapper - container with header */
  .code-block-wrapper {
    border-radius: 0.5rem;
    overflow: hidden;
    margin: 1rem 0;
    background: var(--code);
  }

  /* Header bar with language label and copy button */
  .code-block-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    background: var(--code);
  }

  .code-block-language {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--muted-foreground);
    text-transform: lowercase;
    font-family: ui-sans-serif, system-ui, sans-serif;
  }

  .code-block-copy {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 1.75rem;
    height: 1.75rem;
    color: var(--muted-foreground);
    background: transparent;
    border: none;
    cursor: pointer;
    border-radius: 0.375rem;
    transition: all 0.15s ease;
  }

  .code-block-copy:hover {
    color: var(--foreground);
    background: var(--accent);
  }

  .code-block-copy svg {
    width: 1rem;
    height: 1rem;
  }

  .code-block-copy span {
    display: none;
  }

  .code-block-copy.copied {
    color: var(--primary);
  }

  /* Code content inside wrapper */
  .code-block-wrapper pre {
    margin: 0 !important;
    padding: 1rem !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    overflow-x: auto;
  }

  .code-block-wrapper pre code {
    font-size: 0.875rem;
    line-height: 1.7;
    font-family:
      ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas,
      'Liberation Mono', 'Courier New', monospace;
    background: transparent !important;
    padding: 0 !important;
  }

  /* Inline code styling */
  .app-ai-response-content :not(pre) > code {
    padding: 0.125rem 0.5rem;
    border-radius: 0.375rem;
    background-color: var(--muted);
    font-size: 0.875em;
    font-weight: 500;
    color: theme('colors.emerald.600');
  }

  .dark .app-ai-response-content :not(pre) > code {
    color: theme('colors.emerald.400');
  }

  /* Prose customizations for AI responses */
  .app-ai-response-content {
    /* Headers */
    & h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      margin-top: 1.5rem;
    }

    & h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      margin-top: 1.25rem;
    }

    & h3 {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      margin-top: 1rem;
    }

    /* Paragraphs */
    & p {
      margin-bottom: 0.75rem;
      line-height: 1.7;
    }

    /* Lists */
    & ul,
    & ol {
      margin-top: 0.5rem;
      margin-bottom: 0.75rem;
      padding-left: 1.5rem;
    }

    & li {
      margin-bottom: 0.25rem;
      line-height: 1.6;
    }

    & ul {
      list-style-type: disc;
    }

    & ol {
      list-style-type: decimal;
    }

    /* Blockquotes */
    & blockquote {
      border-left: 4px solid theme('colors.zinc.300');
      padding-left: 1rem;
      margin: 1rem 0;
      color: theme('colors.zinc.600');
      font-style: italic;
    }

    .dark & blockquote {
      border-left-color: theme('colors.zinc.600');
      color: theme('colors.zinc.400');
    }

    /* Links */
    & a {
      color: theme('colors.blue.600');
      text-decoration: underline;
      text-underline-offset: 2px;
    }

    .dark & a {
      color: theme('colors.blue.400');
    }

    & a:hover {
      color: theme('colors.blue.800');
    }

    .dark & a:hover {
      color: theme('colors.blue.300');
    }

    /* Bold and italic */
    & strong {
      font-weight: 600;
    }

    & em {
      font-style: italic;
    }

    /* Horizontal rule */
    & hr {
      border: none;
      border-top: 1px solid var(--border);
      margin: 1.5rem 0;
    }

    /* Tables */
    & table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }

    & th,
    & td {
      border: 1px solid var(--border);
      padding: 0.5rem 0.75rem;
      text-align: left;
    }

    & th {
      background-color: var(--muted);
      font-weight: 600;
    }

    /* First element no top margin */
    & > *:first-child {
      margin-top: 0;
    }

    /* Last element no bottom margin */
    & > *:last-child {
      margin-bottom: 0;
    }
  }

  /* ============================================
     Doc Code Block Line Numbers
     ============================================ */
  .doc-code-line {
    display: block;
  }

  .doc-code-line-number {
    display: inline-block;
    width: 2.5rem;
    padding-right: 1rem;
    text-align: right;
    color: var(--muted-foreground);
    user-select: none;
  }

  .doc-code-line-content {
    display: inline;
  }
}

/* ============================================
   Utility Animations
   ============================================ */

@layer utilities {
  /* Typing Indicator */
  .typing-dot {
    animation: typing-bounce 1.4s infinite ease-in-out both;
  }

  @keyframes typing-bounce {
    0%,
    80%,
    100% {
      transform: scale(0.6);
      opacity: 0.4;
    }
    40% {
      transform: scale(1);
      opacity: 1;
    }
  }

  /* Typing Indicator - Wave Variant */
  .typing-dot-wave {
    animation: typing-wave 1s infinite ease-in-out;
  }

  @keyframes typing-wave {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-4px);
    }
  }

  /* Cursor Blink */
  .animate-cursor-blink {
    animation: cursor-blink 1s step-end infinite;
  }

  @keyframes cursor-blink {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0;
    }
  }

  /* Hide Scrollbar */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Reduced Motion */
  @media (prefers-reduced-motion: reduce) {
    .typing-dot,
    .typing-dot-wave,
    .animate-cursor-blink {
      animation: none;
      opacity: 1;
    }
  }
}
