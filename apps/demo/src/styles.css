/* Angular AI Kit Demo - Design System
 * Architecture: Tailwind CSS v4 + Minimal CSS Variables for Spartan UI
 * Color Scale: Zinc (Tailwind built-in)
 */

@layer theme, base, components, utilities;
@import 'tailwindcss/theme.css' layer(theme);
@import 'tailwindcss/preflight.css' layer(base);
@import 'tailwindcss/utilities.css';
@import '@spartan-ng/brain/hlm-tailwind-preset.css';

/* Import styling from library (single source of truth) */
@import '../../../packages/tokens/src/lib/tokens/code-theme.css';
@import '../../../packages/tokens/src/lib/tokens/animations.css';
@import '../../../packages/tokens/src/lib/tokens/prose.css';

/* Custom theme extensions (variables not in Spartan preset) */
@theme inline {
  /* Code blocks */
  --color-code: var(--code);
  --color-code-foreground: var(--code-foreground);

  /* Extended tokens */
  --color-border-hover: var(--border-hover);
  --color-foreground-muted: var(--foreground-muted);

  /* Message bubble role colors */
  --color-message-user-bg: var(--message-user-bg);
  --color-message-assistant-bg: var(--message-assistant-bg);
  --color-message-system-bg: var(--message-system-bg);
  --color-avatar-user: var(--avatar-user);
  --color-avatar-assistant: var(--avatar-assistant);
  --color-avatar-system: var(--avatar-system);
}

/* Typography plugin for prose styling */
@plugin '@tailwindcss/typography';

@source '../../packages';

/* ============================================
   Semantic Design Tokens
   Using Tailwind theme() for all color values
   ============================================ */

@layer base {
  /* Light Theme (Default) */
  :root {
    /* Core Colors */
    --background: theme('colors.white');
    --foreground: theme('colors.zinc.800');

    /* Card */
    --card: theme('colors.zinc.50');
    --card-foreground: theme('colors.zinc.900');

    /* Popover */
    --popover: theme('colors.white');
    --popover-foreground: theme('colors.zinc.800');

    /* Muted */
    --muted: theme('colors.zinc.100');
    --muted-foreground: theme('colors.zinc.500');

    /* Accent */
    --accent: theme('colors.zinc.100');
    --accent-foreground: theme('colors.zinc.900');

    /* Border & Input */
    --border: theme('colors.zinc.200');
    --border-hover: theme('colors.zinc.300');
    --input: theme('colors.zinc.50');

    /* Inline/Markdown code blocks (subtle) */
    --code: theme('colors.zinc.100');
    --code-foreground: theme('colors.zinc.900');

    /* Message bubble role colors */
    --message-user-bg: theme('colors.zinc.100');
    --message-assistant-bg: theme('colors.white');
    --message-system-bg: theme('colors.zinc.50');
    --avatar-user: theme('colors.zinc.700');
    --avatar-assistant: theme('colors.zinc.800');
    --avatar-system: theme('colors.zinc.400');

    /* Foreground variants */
    --foreground-muted: theme('colors.zinc.500');

    /* Ring */
    --ring: theme('colors.zinc.400');

    /* Primary */
    --primary: theme('colors.zinc.800');
    --primary-foreground: theme('colors.zinc.50');

    /* Secondary */
    --secondary: theme('colors.zinc.100');
    --secondary-foreground: theme('colors.zinc.800');

    /* Destructive */
    --destructive: theme('colors.red.500');
    --destructive-foreground: theme('colors.zinc.50');

    /* Link colors (for prose content) */
    --link: theme('colors.blue.600');
    --link-hover: theme('colors.blue.800');

    /* Inline code color */
    --inline-code: theme('colors.emerald.600');

    /* Border Radius */
    --radius: 0.5rem;
  }

  /* Dark Theme */
  .dark {
    /* Core Colors */
    --background: theme('colors.zinc.950');
    --foreground: theme('colors.zinc.200');

    /* Card */
    --card: theme('colors.zinc.900');
    --card-foreground: theme('colors.zinc.100');

    /* Popover */
    --popover: theme('colors.zinc.900');
    --popover-foreground: theme('colors.zinc.100');

    /* Muted */
    --muted: theme('colors.zinc.900');
    --muted-foreground: theme('colors.zinc.400');

    /* Accent */
    --accent: theme('colors.zinc.800');
    --accent-foreground: theme('colors.zinc.50');

    /* Border & Input */
    --border: theme('colors.zinc.800');
    --border-hover: theme('colors.zinc.600');
    --input: theme('colors.zinc.900');

    /* Code blocks */
    --code: theme('colors.zinc.900');
    --code-foreground: theme('colors.zinc.100');

    /* Message bubble role colors */
    --message-user-bg: theme('colors.zinc.800');
    --message-assistant-bg: theme('colors.zinc.900');
    --message-system-bg: theme('colors.zinc.800/50');
    --avatar-user: theme('colors.zinc.600');
    --avatar-assistant: theme('colors.zinc.700');
    --avatar-system: theme('colors.zinc.500');

    /* Foreground variants */
    --foreground-muted: theme('colors.zinc.500');

    /* Ring */
    --ring: theme('colors.zinc.500');

    /* Primary */
    --primary: theme('colors.zinc.100');
    --primary-foreground: theme('colors.zinc.900');

    /* Secondary */
    --secondary: theme('colors.zinc.800');
    --secondary-foreground: theme('colors.zinc.50');

    /* Link colors (for prose content) */
    --link: theme('colors.blue.400');
    --link-hover: theme('colors.blue.300');

    /* Inline code color */
    --inline-code: theme('colors.emerald.400');
  }

  /* Base HTML Styles */
  html {
    scroll-behavior: smooth;
  }

  body {
    font-family: theme('fontFamily.sans');
    background-color: var(--background);
    color: var(--foreground);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Selection */
  ::selection {
    background-color: var(--primary);
    color: var(--primary-foreground);
  }

  /* Focus Ring */
  :focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
  }

  /* Scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 9999px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--muted-foreground);
  }

  /* Firefox scrollbar */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }
}

/* ============================================
   Component Styles
   ============================================ */

@layer components {
  /* CDK Dialog Overlay */
  .cdk-overlay-dark-backdrop {
    background-color: rgb(0 0 0 / 0.5);
    backdrop-filter: blur(4px);
    animation: overlay-fade-in 150ms ease-out;
  }

  /* Command Dialog Panel */
  .command-dialog-panel {
    background-color: var(--background);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: theme('boxShadow.lg');
    overflow: hidden;
    outline: none;
    animation: dialog-slide-in 150ms ease-out;
  }

  /* CDK Overlay Centering */
  .cdk-global-overlay-wrapper {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding-top: 15vh;
  }

  /* Note: Dialog animations (overlay-fade-in, dialog-slide-in) are imported from animations.css */

  /* Sidebar Host */
  .app-sidebar-host {
    overflow-x: hidden !important;
  }

  /* ============================================
     Angular Template Syntax Highlighting (Demo-specific)
     Enhanced highlighting for Angular-specific syntax
     ============================================ */

  /* Property binding brackets: [ ] */
  .hljs-ng-binding {
    color: #cf222e;
  }

  .dark .hljs-ng-binding {
    color: #ff7b72;
  }

  /* Property names inside [property] */
  .hljs-ng-property {
    color: #8250df;
  }

  .dark .hljs-ng-property {
    color: #d2a8ff;
  }

  /* Event names inside (event) */
  .hljs-ng-event {
    color: #0550ae;
  }

  .dark .hljs-ng-event {
    color: #79c0ff;
  }

  /* Two-way binding names [(ngModel)] */
  .hljs-ng-twoway {
    color: #953800;
  }

  .dark .hljs-ng-twoway {
    color: #ffa657;
  }

  /* Control flow: @if, @for, @switch, @defer, etc. */
  .hljs-ng-control {
    color: #cf222e;
    font-weight: 600;
  }

  .dark .hljs-ng-control {
    color: #ff7b72;
    font-weight: 600;
  }

  /* Template reference variables: #ref */
  .hljs-ng-ref {
    color: #116329;
  }

  .dark .hljs-ng-ref {
    color: #7ee787;
  }

  /* Structural directives: *ngIf, *ngFor */
  .hljs-ng-structural {
    color: #cf222e;
  }

  .dark .hljs-ng-structural {
    color: #ff7b72;
  }

  /* ============================================
     Demo-specific Code Block Styling
     (For markdown.service.ts which uses code-block-* classes)
     Library ai-code-block-* styles are imported from @angular-ai-kit/tokens
     ============================================ */

  /* Code block wrapper - demo only (without ai- prefix) */
  .code-block-wrapper {
    border-radius: 0.5rem;
    overflow: hidden;
    margin: 1rem 0;
    background: var(--code);
  }

  /* Header bar with language label and copy button */
  .code-block-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    background: var(--code);
  }

  .code-block-language {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--muted-foreground);
    text-transform: lowercase;
    font-family: ui-sans-serif, system-ui, sans-serif;
  }

  .code-block-copy {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 1.75rem;
    height: 1.75rem;
    color: var(--muted-foreground);
    background: transparent;
    border: none;
    cursor: pointer;
    border-radius: 0.375rem;
    transition: all 0.15s ease;
  }

  .code-block-copy:hover {
    color: var(--foreground);
    background: var(--accent);
  }

  .code-block-copy svg {
    width: 1rem;
    height: 1rem;
  }

  .code-block-copy span {
    display: none;
  }

  .code-block-copy.copied {
    color: var(--primary);
  }

  /* Code content inside wrapper */
  .code-block-wrapper pre {
    margin: 0 !important;
    padding: 1rem !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    overflow-x: auto;
  }

  .code-block-wrapper pre code {
    font-size: 0.875rem;
    line-height: 1.7;
    font-family:
      ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas,
      'Liberation Mono', 'Courier New', monospace;
    background: transparent !important;
    padding: 0 !important;
  }

  /* Inline code styling - demo-specific (app-ai-response-content) */
  /* Library's .ai-response-content prose styles are imported from prose.css */
  .app-ai-response-content :not(pre) > code {
    padding: 0.125rem 0.5rem;
    border-radius: 0.375rem;
    background-color: var(--muted);
    font-size: 0.875em;
    font-weight: 500;
    color: var(--inline-code);
  }

  /* ============================================
     Doc Code Block Line Numbers
     ============================================ */
  .doc-code-line {
    display: block;
  }

  .doc-code-line-number {
    display: inline-block;
    width: 2.5rem;
    padding-right: 1rem;
    text-align: right;
    color: var(--muted-foreground);
    user-select: none;
  }

  .doc-code-line-content {
    display: inline;
  }
}

/* Note: Animation utilities (typing-dot, cursor-blink, scrollbar-hide, etc.)
   are imported from animations.css */
